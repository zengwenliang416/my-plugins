## ADDED Requirements

### Requirement: Integrated D2C+P2C Pipeline
The system SHALL provide a unified command that executes the D2C and P2C workflows sequentially, where the P2C phase builds upon the UI code generated by the D2C phase to produce integrated component code with both visual structure and business logic.

#### Scenario: Full pipeline with existing PRD
- **WHEN** the user invokes the full pipeline with design screenshots, PRD files, and a target tech stack
- **THEN** the system SHALL first generate UI component code from the screenshots, then parse the PRD, retrieve project context, and generate logic code that integrates directly into the UI components

#### Scenario: Full pipeline without PRD
- **WHEN** the user invokes the full pipeline with design screenshots but no PRD files
- **THEN** the system SHALL generate UI code first, then automatically generate a structured PRD by inferring interactions, states, and data requirements from the design screenshots, present the generated PRD for user review, and proceed to logic code generation after user approval

#### Scenario: Phase data continuity
- **WHEN** the P2C phase begins after D2C completion
- **THEN** the P2C phase SHALL read and reuse all D2C artifacts (visual-analysis.md, generated component structure) without re-analyzing the design screenshots

### Requirement: PRD Generation from Design and Description
The system SHALL generate structured PRD documents from design screenshots and/or user natural language descriptions, supporting three input modes: design-only, description-only, and merged.

#### Scenario: Design-driven PRD generation
- **WHEN** the user provides design screenshots without a PRD
- **THEN** the prd-generator agent SHALL analyze the screenshots to infer interactive elements, state transitions, navigation flows, and API data requirements, and output a structured PRD with confidence levels and explicit gaps

#### Scenario: Description-driven PRD generation
- **WHEN** the user provides a natural language description without design screenshots
- **THEN** the prd-generator agent SHALL parse the description into structured modules, requirements, interactions, and states, and ask clarifying questions for vague descriptions

#### Scenario: Merged PRD generation
- **WHEN** the user provides both design screenshots and a natural language description
- **THEN** the prd-generator agent SHALL combine design inference with user description, with user description taking priority over design inference on conflicts, and output a unified structured PRD

#### Scenario: PRD review gate
- **WHEN** the prd-generator completes PRD generation
- **THEN** the system SHALL present the generated PRD summary (module count, confidence levels, gaps, assumptions) and wait for user approval before proceeding to logic code generation

### Requirement: Hard Stop Confirmation Gates
The system SHALL pause for user confirmation at critical decision points before proceeding to irreversible or resource-intensive phases.

#### Scenario: Design analysis confirmation
- **WHEN** the design-analyzer completes visual analysis
- **THEN** the system SHALL present the analysis summary to the user and wait for confirmation before proceeding to code generation

#### Scenario: Generated PRD confirmation
- **WHEN** the prd-generator completes PRD generation
- **THEN** the system SHALL present the PRD with gaps and assumptions highlighted, and wait for user acceptance, editing, or regeneration

#### Scenario: Delivery confirmation
- **WHEN** all code generation is complete
- **THEN** the system SHALL present a summary of generated files, component count, and coverage before the user accepts the output

### Requirement: Multi-Tech-Stack Support
The system SHALL support configurable target technology stacks through a skill-based adapter system. V1 supports React and Vue; additional stacks (React Native, Taro) are deferred to v2.

#### Scenario: Tech stack selection
- **WHEN** the user specifies a target tech stack (React or Vue)
- **THEN** the tech-stack-adapter skill SHALL load the corresponding framework reference and inject framework-specific rules into the code generation prompts

#### Scenario: Unsupported tech stack
- **WHEN** the user specifies a tech stack not yet supported (e.g., React Native, Taro)
- **THEN** the system SHALL inform the user that the requested stack is planned for v2 and offer to proceed with React or Vue instead
