#!/bin/bash
# =============================================================================
# compact-evaluator.sh - 上下文压缩评估器 Hook
# =============================================================================
# 用途: 压缩前分析信息密度，防止关键决策被误删
# 触发: PreCompact
# 类型: prompt (输出指令注入上下文)
# 优先级: P0 - 信息保护
# =============================================================================

cat << 'EOF'
📦 **上下文压缩前评估**

在压缩上下文前，请执行以下评估：

## 1. 关键决策识别
识别并保留本次会话中的关键架构决策：
- 技术选型决策及其理由
- 放弃的方案及原因
- 重要的约束条件

## 2. 未完成任务状态
确保以下信息不被压缩删除：
- 当前待办事项列表
- 任务进度和下一步操作
- 阻塞问题和依赖关系

## 3. 重要上下文
保留对后续工作至关重要的信息：
- 用户明确指定的需求和约束
- 关键的文件路径和配置
- 重要的代码引用 (file:line)

## 4. 压缩建议
- 可以压缩：探索性尝试、重复的日志输出、已解决的问题详情
- 必须保留：最终决策、待办事项、关键路径

---
请在压缩时优先保留以上信息，避免关键上下文丢失。
EOF
