# 非功能需求（NFR）清单

## 概述

本文档列出了常见的非功能需求类别，用于在需求解析时识别隐含的质量属性。

## 性能（Performance）

### 响应时间

| 场景       | 目标                   | 度量方式   |
| ---------- | ---------------------- | ---------- |
| API 响应   | P95 < 200ms            | APM 监控   |
| 页面加载   | FCP < 1.5s, LCP < 2.5s | Lighthouse |
| 数据库查询 | P95 < 100ms            | Query 分析 |

### 吞吐量

| 场景     | 目标        | 度量方式 |
| -------- | ----------- | -------- |
| 并发用户 | > 1000      | 压力测试 |
| API QPS  | > 500/s     | 负载测试 |
| 消息处理 | > 10000/min | 队列监控 |

### 资源使用

| 资源 | 目标  | 度量方式 |
| ---- | ----- | -------- |
| CPU  | < 80% | 监控告警 |
| 内存 | < 85% | 监控告警 |
| 磁盘 | < 70% | 监控告警 |

## 安全（Security）

### 认证与授权

| 需求     | 描述                                 |
| -------- | ------------------------------------ |
| 密码策略 | 长度 >= 8，包含大小写+数字+特殊字符  |
| 会话管理 | JWT 过期时间 15min，refresh token 7d |
| MFA      | 敏感操作需要二次验证                 |
| RBAC     | 基于角色的访问控制                   |

### 数据保护

| 需求     | 描述               |
| -------- | ------------------ |
| 传输加密 | TLS 1.2+           |
| 存储加密 | AES-256            |
| 密码存储 | bcrypt/argon2 哈希 |
| 敏感数据 | 脱敏显示           |

### OWASP Top 10

| 风险               | 防护措施                |
| ------------------ | ----------------------- |
| A01 访问控制失效   | 权限检查、最小权限原则  |
| A02 加密失败       | TLS、密码哈希、密钥管理 |
| A03 注入           | 参数化查询、输入验证    |
| A04 不安全设计     | 威胁建模、安全设计评审  |
| A05 安全配置错误   | 安全基线、自动化扫描    |
| A06 脆弱组件       | 依赖扫描、及时更新      |
| A07 认证失败       | MFA、会话管理、密码策略 |
| A08 数据完整性失败 | 签名验证、CI/CD 安全    |
| A09 日志监控失效   | 集中日志、告警机制      |
| A10 SSRF           | 白名单、网络隔离        |

## 可用性（Availability）

### SLA 等级

| 等级    | 可用率    | 年停机时间 |
| ------- | --------- | ---------- |
| 99%     | 3.65 天   | 基础服务   |
| 99.9%   | 8.76 小时 | 标准服务   |
| 99.99%  | 52.6 分钟 | 关键服务   |
| 99.999% | 5.26 分钟 | 核心服务   |

### 容错设计

| 需求     | 描述               |
| -------- | ------------------ |
| 故障转移 | 主备切换 < 30s     |
| 数据备份 | 每日增量，每周全量 |
| 灾难恢复 | RPO < 1h, RTO < 4h |
| 降级策略 | 熔断、限流、兜底   |

## 可扩展性（Scalability）

### 水平扩展

| 需求       | 描述           |
| ---------- | -------------- |
| 无状态设计 | 会话外部化     |
| 负载均衡   | 支持动态扩缩容 |
| 数据分片   | 支持分库分表   |

### 垂直扩展

| 需求     | 描述              |
| -------- | ----------------- |
| 资源优化 | 支持增加 CPU/内存 |
| 缓存策略 | 多级缓存          |

## 可维护性（Maintainability）

### 代码质量

| 指标       | 目标          |
| ---------- | ------------- |
| 测试覆盖   | > 80%         |
| 代码复杂度 | 圈复杂度 < 10 |
| 技术债务   | 可控          |

### 可观测性

| 需求 | 描述                 |
| ---- | -------------------- |
| 日志 | 结构化日志，可搜索   |
| 指标 | Prometheus + Grafana |
| 追踪 | 分布式链路追踪       |
| 告警 | 阈值告警 + 异常检测  |

### 文档

| 需求     | 描述            |
| -------- | --------------- |
| API 文档 | OpenAPI/Swagger |
| 架构文档 | arc42           |
| 操作手册 | 运维指南        |

## 可访问性（Accessibility）

### WCAG 2.1 标准

| 等级 | 要求               |
| ---- | ------------------ |
| A    | 基本可访问         |
| AA   | 增强可访问（推荐） |
| AAA  | 最高可访问         |

### 关键需求

| 需求       | 描述               |
| ---------- | ------------------ |
| 键盘导航   | 所有功能可键盘操作 |
| 屏幕阅读器 | 语义化 HTML + ARIA |
| 颜色对比   | 对比度 >= 4.5:1    |
| 文本缩放   | 支持 200% 缩放     |

## 国际化（Internationalization）

| 需求     | 描述             |
| -------- | ---------------- |
| 多语言   | i18n 支持        |
| 时区     | 用户时区处理     |
| 日期格式 | 本地化格式       |
| 货币     | 多币种支持       |
| RTL      | 从右到左语言支持 |

## 合规性（Compliance）

| 法规    | 要求                           |
| ------- | ------------------------------ |
| GDPR    | 数据保护、用户同意、数据可携带 |
| CCPA    | 加州消费者隐私                 |
| HIPAA   | 医疗数据保护                   |
| PCI-DSS | 支付卡数据安全                 |
| SOC 2   | 服务组织控制                   |
