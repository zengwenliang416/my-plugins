# OWASP Impact Factors

影响评估的详细因素分解和评分指南。

## 概述

```
Impact = (Technical Impact + Business Impact) / 2
       = ((TI1 + TI2 + TI3 + TI4) / 4 + (BI1 + BI2 + BI3 + BI4) / 4) / 2
```

## 1. 技术影响 (Technical Impact)

评估对系统技术层面的影响。

### 1.1 保密性损失 (Loss of Confidentiality)

敏感信息被未授权访问的程度。

| 分数 | 等级       | 描述                 | 软件项目示例         |
| ---- | ---------- | -------------------- | -------------------- |
| 0    | 无泄露     | 无任何信息泄露       | 仅影响 UI 显示       |
| 2    | 少量非敏感 | 少量公开或低价值信息 | 错误消息暴露版本号   |
| 4    | 大量非敏感 | 大量非敏感信息泄露   | 用户公开资料批量泄露 |
| 6    | 少量敏感   | 少量敏感信息泄露     | 单个用户密码泄露     |
| 7    | 大量敏感   | 大量敏感信息泄露     | 批量用户凭证泄露     |
| 9    | 全部敏感   | 所有敏感数据完全泄露 | 数据库完整备份泄露   |

### 1.2 完整性损失 (Loss of Integrity)

数据或系统被未授权修改的程度。

| 分数 | 等级     | 描述                 | 软件项目示例       |
| ---- | -------- | -------------------- | ------------------ |
| 0    | 无篡改   | 无任何数据被修改     | 只读信息泄露       |
| 2    | 少量轻微 | 少量非关键数据被修改 | 用户昵称被篡改     |
| 4    | 大量轻微 | 大量非关键数据被修改 | 批量评论被删除     |
| 6    | 少量严重 | 少量关键数据被修改   | 单个订单金额被篡改 |
| 7    | 大量严重 | 大量关键数据被修改   | 批量交易记录被篡改 |
| 9    | 全部数据 | 所有数据可被任意修改 | 可删库、完全控制   |

### 1.3 可用性损失 (Loss of Availability)

服务中断或不可用的程度。

| 分数 | 等级     | 描述                 | 软件项目示例         |
| ---- | -------- | -------------------- | -------------------- |
| 0    | 无中断   | 服务完全正常         | 仅日志记录受影响     |
| 2    | 次要服务 | 非核心功能受影响     | 头像上传功能暂停     |
| 4    | 部分中断 | 部分用户或功能受影响 | 特定地区用户无法访问 |
| 6    | 主要服务 | 核心功能受影响       | 支付功能中断 1 小时  |
| 7    | 严重中断 | 大部分服务不可用     | 网站宕机数小时       |
| 9    | 全部服务 | 完全不可用、数据丢失 | 服务器被加密勒索     |

### 1.4 可审计损失 (Loss of Accountability)

追踪和审计能力的丧失程度。

| 分数 | 等级     | 描述               | 软件项目示例           |
| ---- | -------- | ------------------ | ---------------------- |
| 0    | 完全追溯 | 所有操作可完整追溯 | 完整审计日志、不可篡改 |
| 2    | 可能追溯 | 大部分操作可追溯   | 有日志但部分缺失       |
| 4    | 部分追溯 | 仅部分操作可追溯   | 仅关键操作有日志       |
| 6    | 难以追溯 | 追溯困难但理论可行 | 需要关联多系统日志     |
| 7    | 极难追溯 | 几乎无法追溯       | 日志被篡改或删除       |
| 9    | 无法追溯 | 完全匿名、无法追责 | 无任何日志记录         |

## 2. 业务影响 (Business Impact)

评估对业务层面的影响。

### 2.1 财务损失 (Financial Damage)

直接和间接的财务影响。

| 分数 | 等级     | 描述                 | 软件项目示例         |
| ---- | -------- | -------------------- | -------------------- |
| 0    | 微乎其微 | 损失小于修复成本     | 内部工具 bug         |
| 2    | 小于利润 | 损失在年利润 1% 以内 | 小额退款处理         |
| 4    | 影响利润 | 损失影响季度利润     | 服务中断导致订单流失 |
| 6    | 重大影响 | 损失影响年度财务     | 数据泄露赔偿         |
| 7    | 严重损失 | 可能需要裁员或重组   | 大规模安全事件       |
| 9    | 破产级别 | 公司可能无法继续运营 | 核心业务数据永久丢失 |

### 2.2 声誉损失 (Reputation Damage)

对品牌和用户信任的影响。

| 分数 | 等级     | 描述             | 软件项目示例       |
| ---- | -------- | ---------------- | ------------------ |
| 0    | 无影响   | 用户无感知       | 内部系统问题       |
| 2    | 少量用户 | 仅少数用户知晓   | 个别用户投诉       |
| 4    | 部分用户 | 部分用户流失     | 社交媒体负面讨论   |
| 6    | 大量用户 | 大量用户流失     | 媒体报道安全问题   |
| 7    | 行业级别 | 行业内广泛知晓   | 登上安全事件排行榜 |
| 9    | 品牌级别 | 品牌价值严重受损 | 成为反面典型案例   |

### 2.3 合规影响 (Non-compliance)

法规和合规性影响。

| 分数 | 等级     | 描述                 | 软件项目示例         |
| ---- | -------- | -------------------- | -------------------- |
| 0    | 无影响   | 完全合规             | 无法规相关问题       |
| 2    | 轻微违规 | 轻微违规、内部整改   | 日志保留期不足       |
| 4    | 明确违规 | 需要报告监管机构     | GDPR 数据泄露通知    |
| 6    | 严重违规 | 面临罚款             | 违反 PCI-DSS 要求    |
| 7    | 高调违规 | 大额罚款、许可证风险 | 多次违规被调查       |
| 9    | 重大违规 | 吊销许可、刑事责任   | 故意违规、高管被追责 |

### 2.4 隐私影响 (Privacy Violation)

用户隐私被侵犯的程度。

| 分数 | 等级     | 描述               | 软件项目示例         |
| ---- | -------- | ------------------ | -------------------- |
| 0    | 无影响   | 无隐私数据涉及     | 公开信息处理         |
| 2    | 单用户   | 单个用户隐私受影响 | 单个账户信息泄露     |
| 4    | 数百用户 | 小规模隐私泄露     | 小批量用户数据泄露   |
| 6    | 数千用户 | 中规模隐私泄露     | 特定功能用户数据泄露 |
| 7    | 数万用户 | 大规模隐私泄露     | 产品线用户数据泄露   |
| 9    | 百万用户 | 超大规模隐私泄露   | 全平台用户数据泄露   |

## 3. 评分示例

### 示例 1：用户凭证批量泄露

```yaml
risk_id: R-001
scenario: 数据库注入导致用户密码哈希泄露

technical_impact:
  confidentiality: 7 # 大量敏感 - 批量凭证泄露
  integrity: 0 # 无篡改 - 只读查询
  availability: 0 # 无中断 - 服务正常
  accountability: 4 # 部分追溯 - 有查询日志
  average: 2.75

business_impact:
  financial: 6 # 重大影响 - 需要赔偿和安全改造
  reputation: 6 # 大量用户 - 信任危机
  non_compliance: 4 # 明确违规 - 需要通知用户和监管
  privacy: 7 # 数万用户 - 大规模隐私泄露
  average: 5.75

impact: 4.25 # (2.75 + 5.75) / 2
impact_level: MEDIUM-HIGH
```

### 示例 2：核心服务 DDoS 中断

```yaml
risk_id: R-002
scenario: 支付服务遭受 DDoS 攻击中断 4 小时

technical_impact:
  confidentiality: 0 # 无泄露
  integrity: 0 # 无篡改
  availability: 6 # 主要服务 - 支付功能中断
  accountability: 0 # 完全追溯 - 攻击可追踪
  average: 1.5

business_impact:
  financial: 6 # 重大影响 - 4 小时订单损失
  reputation: 4 # 部分用户 - 社交媒体投诉
  non_compliance: 2 # 轻微违规 - SLA 未达标
  privacy: 0 # 无影响
  average: 3.0

impact: 2.25 # (1.5 + 3.0) / 2
impact_level: LOW-MEDIUM
```

## 4. 评估检查清单

### 技术影响评估问题

- [ ] 有多少敏感数据可能泄露？
- [ ] 数据可能被如何篡改？
- [ ] 服务中断会影响多少用户？
- [ ] 我们能追溯到责任人吗？

### 业务影响评估问题

- [ ] 预计财务损失是多少？
- [ ] 会影响多少用户的信任？
- [ ] 涉及哪些法规合规要求？
- [ ] 有多少用户的隐私受影响？

## 5. 快速评估卡

| 分数 | Impact 等级 | 典型场景                   |
| ---- | ----------- | -------------------------- |
| 7-9  | HIGH        | 全量数据泄露、服务完全中断 |
| 4-6  | MEDIUM      | 部分敏感数据、核心功能受损 |
| 0-3  | LOW         | 非敏感信息、次要功能影响   |

## 6. 行业特定影响因素

### 金融行业

| 因素       | 权重 | 说明                      |
| ---------- | ---- | ------------------------- |
| 财务合规   | 1.5x | PCI-DSS、SOX 等要求更严格 |
| 交易完整性 | 2x   | 交易数据篡改影响翻倍      |
| 实时可用性 | 1.5x | 交易窗口期服务更关键      |

### 医疗行业

| 因素       | 权重 | 说明                     |
| ---------- | ---- | ------------------------ |
| 隐私合规   | 2x   | HIPAA 等隐私法规更严格   |
| 数据完整性 | 1.5x | 医疗记录错误可能危及生命 |
| 可用性     | 2x   | 紧急医疗系统中断更致命   |

### 政府/公共服务

| 因素     | 权重 | 说明                     |
| -------- | ---- | ------------------------ |
| 公众信任 | 2x   | 政府服务信任影响更大     |
| 国家安全 | 3x   | 涉及国家安全时影响极大   |
| 公平性   | 1.5x | 服务不平等会引发社会问题 |
