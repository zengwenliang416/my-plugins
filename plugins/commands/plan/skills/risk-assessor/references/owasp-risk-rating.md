# OWASP Risk Rating Methodology

基于 OWASP 风险评分方法论的项目风险评估指南。

## 1. 核心公式

```
Risk = Likelihood × Impact
```

### 风险等级矩阵

|              | Impact LOW (0-3) | Impact MEDIUM (3-6) | Impact HIGH (6-9) |
| ------------ | ---------------- | ------------------- | ----------------- |
| **HIGH** L   | Medium           | High                | Critical          |
| **MEDIUM** L | Low              | Medium              | High              |
| **LOW** L    | Note             | Low                 | Medium            |

### 数值映射

| 等级     | 分数范围 | 颜色  | 响应时间 |
| -------- | -------- | ----- | -------- |
| Critical | 7-9      | 🔴 红 | 立即     |
| High     | 5-7      | 🟠 橙 | 24h      |
| Medium   | 3-5      | 🟡 黄 | 1 周     |
| Low      | 1-3      | 🟢 绿 | 下迭代   |
| Note     | 0-1      | ⚪ 灰 | 记录     |

## 2. Likelihood 评估

Likelihood = (Threat Agent Factors + Vulnerability Factors) / 2

### 2.1 威胁代理因素 (Threat Agent)

| 因素     | 0            | 3            | 6            | 9        |
| -------- | ------------ | ------------ | ------------ | -------- |
| 技能等级 | 无技能       | 基础技能     | 中级技能     | 高级专家 |
| 动机     | 无动机       | 可能有益     | 高回报       | 巨大利益 |
| 机会     | 需要完全访问 | 需要部分访问 | 有限访问即可 | 无需访问 |
| 规模     | 单一开发者   | 小团队       | 中等组织     | 大型群体 |

### 2.2 漏洞因素 (Vulnerability)

| 因素     | 0          | 3      | 6        | 9          |
| -------- | ---------- | ------ | -------- | ---------- |
| 易发现性 | 几乎不可能 | 困难   | 容易     | 自动化工具 |
| 易利用性 | 理论可行   | 困难   | 容易     | 自动化攻击 |
| 认知程度 | 未知       | 隐藏   | 明显     | 公开已知   |
| 入侵检测 | 主动检测   | 有日志 | 偶尔日志 | 无日志     |

## 3. Impact 评估

Impact = (Technical Impact + Business Impact) / 2

### 3.1 技术影响 (Technical Impact)

| 因素       | 0        | 3          | 6          | 9        |
| ---------- | -------- | ---------- | ---------- | -------- |
| 保密性损失 | 无泄露   | 少量非敏感 | 大量非敏感 | 全部敏感 |
| 完整性损失 | 无篡改   | 少量轻微   | 大量严重   | 全部数据 |
| 可用性损失 | 无中断   | 次要服务   | 主要服务   | 全部服务 |
| 可审计损失 | 完全追溯 | 可能追溯   | 难以追溯   | 无法追溯 |

### 3.2 业务影响 (Business Impact)

| 因素     | 0      | 3        | 6        | 9        |
| -------- | ------ | -------- | -------- | -------- |
| 财务损失 | < 修复 | 小于利润 | 重大影响 | 破产级别 |
| 声誉损失 | 无     | 少量用户 | 大量用户 | 品牌级别 |
| 合规影响 | 无     | 轻微违规 | 明确违规 | 高调违规 |
| 隐私影响 | 无     | 单用户   | 数千用户 | 百万用户 |

## 4. 评估流程

```
┌─────────────────────────────────────────────────────────┐
│                    识别风险场景                          │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  评估 Likelihood                 评估 Impact            │
│  ├─ 威胁代理因素 (4 项)          ├─ 技术影响 (4 项)      │
│  └─ 漏洞因素 (4 项)              └─ 业务影响 (4 项)      │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   计算风险分数                           │
│        Likelihood (0-9) × Impact (0-9) = Risk          │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   确定风险等级                           │
│           Critical / High / Medium / Low / Note        │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   制定缓解策略                           │
│         Avoid / Transfer / Mitigate / Accept           │
└─────────────────────────────────────────────────────────┘
```

## 5. 软件项目风险分类

### 5.1 技术风险

| 类别     | 典型风险                             |
| -------- | ------------------------------------ |
| 架构风险 | 技术选型失误、架构不可扩展、单点故障 |
| 实现风险 | 复杂算法、第三方依赖、性能瓶颈       |
| 集成风险 | API 不兼容、数据格式不一致、版本冲突 |
| 安全风险 | 注入攻击、认证绕过、敏感数据泄露     |
| 运维风险 | 部署失败、回滚困难、监控盲区         |

### 5.2 项目风险

| 类别     | 典型风险                             |
| -------- | ------------------------------------ |
| 需求风险 | 需求模糊、范围蔓延、频繁变更         |
| 资源风险 | 技能缺口、人员流失、设备不足         |
| 时间风险 | 估算偏差、关键路径延迟、外部依赖延期 |
| 沟通风险 | 信息不对称、利益相关者冲突、文档缺失 |

### 5.3 业务风险

| 类别     | 典型风险                     |
| -------- | ---------------------------- |
| 市场风险 | 竞品抢先、需求变化、市场萎缩 |
| 合规风险 | 法规变化、审计失败、认证过期 |
| 运营风险 | 用户流失、成本超支、收入下降 |

## 6. 缓解策略

### 策略类型

| 策略     | 描述             | 适用场景         | 示例                   |
| -------- | ---------------- | ---------------- | ---------------------- |
| Avoid    | 消除风险根源     | 高影响、可规避   | 更换有漏洞的库         |
| Transfer | 转移风险责任     | 专业性强、成本高 | 购买保险、外包安全审计 |
| Mitigate | 降低可能性或影响 | 可控、有对策     | 添加验证、增加监控     |
| Accept   | 接受风险         | 低影响、成本高   | 记录并定期复审         |

### 缓解措施模板

```yaml
mitigation:
  strategy: mitigate
  controls:
    preventive:
      - 输入验证
      - 访问控制
    detective:
      - 日志审计
      - 异常监控
    corrective:
      - 回滚机制
      - 应急预案
  timeline: 2 周
  owner: 安全团队
  verification: 渗透测试
```

## 7. 持续风险管理

### 复审周期

| 风险等级 | 复审周期 | 报告级别   |
| -------- | -------- | ---------- |
| Critical | 每日     | 高管层     |
| High     | 每周     | 项目经理   |
| Medium   | 每月     | 团队负责人 |
| Low      | 每季度   | 团队内部   |

### 风险趋势追踪

```
风险分数趋势图
  9 ┤
    │  ●───●
  6 ┤       ╲
    │        ●───●
  3 ┤              ╲
    │               ●───●
  0 ┼──────────────────────
    W1   W2   W3   W4   W5
```

## 参考资料

- [OWASP Risk Rating Methodology](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology)
- [NIST Risk Management Framework](https://csrc.nist.gov/projects/risk-management)
- [ISO 31000 Risk Management](https://www.iso.org/iso-31000-risk-management.html)
