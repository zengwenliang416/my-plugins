# OWASP Likelihood Factors

可能性评估的详细因素分解和评分指南。

## 概述

```
Likelihood = (Threat Agent Factors + Vulnerability Factors) / 2
           = ((TA1 + TA2 + TA3 + TA4) / 4 + (VF1 + VF2 + VF3 + VF4) / 4) / 2
```

## 1. 威胁代理因素 (Threat Agent Factors)

评估攻击者/问题来源的特征。

### 1.1 技能等级 (Skill Level)

攻击者或问题发起者需要的技术能力。

| 分数 | 等级   | 描述             | 软件项目示例              |
| ---- | ------ | ---------------- | ------------------------- |
| 0    | 无技能 | 无需技术知识     | 公开 UI 误操作            |
| 1    | 初学者 | 基础计算机操作   | 社会工程攻击              |
| 3    | 基础   | 了解基本概念     | 使用公开工具扫描          |
| 5    | 中级   | 可编写简单脚本   | 自定义攻击脚本            |
| 6    | 高级   | 深入了解系统原理 | 逆向分析、漏洞挖掘        |
| 9    | 专家   | 顶级安全研究员   | 0day 发现、高级持久化攻击 |

### 1.2 动机 (Motive)

攻击者获得的潜在收益。

| 分数 | 等级     | 描述              | 软件项目示例         |
| ---- | -------- | ----------------- | -------------------- |
| 0    | 无动机   | 无可获取利益      | 内部工具、无敏感数据 |
| 1    | 低回报   | 微小利益          | 公开信息、展示类网站 |
| 4    | 可能有益 | 中等利益          | 普通用户数据         |
| 6    | 高回报   | 显著利益          | 支付信息、商业机密   |
| 9    | 巨大利益 | 重大财务/战略价值 | 金融系统、政府系统   |

### 1.3 机会 (Opportunity)

获取访问权限或触发问题的难度。

| 分数 | 等级         | 描述                   | 软件项目示例                 |
| ---- | ------------ | ---------------------- | ---------------------------- |
| 0    | 完全访问     | 需要物理访问或内部权限 | 需要 VPN + 双因素 + 物理令牌 |
| 2    | 特殊访问     | 需要特定账户或网络位置 | 需要员工账户                 |
| 4    | 部分访问     | 需要注册或认证         | 需要用户注册                 |
| 7    | 有限访问即可 | 公开接口但有限制       | API 限流但可绕过             |
| 9    | 无需访问     | 完全公开               | 公开 API、无认证端点         |

### 1.4 规模 (Size)

潜在攻击者/问题发起者的群体规模。

| 分数 | 等级     | 描述           | 软件项目示例           |
| ---- | -------- | -------------- | ---------------------- |
| 0    | 单人     | 单一内部人员   | 系统管理员             |
| 2    | 小团队   | 少数特定人员   | 开发团队成员           |
| 4    | 中等组织 | 数十到数百人   | 竞争对手               |
| 6    | 大型群体 | 成千上万人     | 黑客组织               |
| 9    | 全球     | 任何互联网用户 | 脚本小子、自动化扫描器 |

## 2. 漏洞因素 (Vulnerability Factors)

评估漏洞或问题本身的特征。

### 2.1 易发现性 (Ease of Discovery)

发现问题的难度。

| 分数 | 等级       | 描述                   | 软件项目示例                 |
| ---- | ---------- | ---------------------- | ---------------------------- |
| 0    | 几乎不可能 | 需要源码审计或内部信息 | 仅在特定条件下触发的竞态条件 |
| 2    | 困难       | 需要深入分析           | 复杂业务逻辑漏洞             |
| 4    | 容易       | 常规测试可发现         | 表单注入、权限绕过           |
| 7    | 自动化工具 | 扫描器可直接发现       | SQL 注入、XSS                |
| 9    | 公开已知   | CVE 公告、漏洞库已收录 | 已披露的框架漏洞             |

### 2.2 易利用性 (Ease of Exploit)

成功利用问题的难度。

| 分数 | 等级     | 描述             | 软件项目示例                   |
| ---- | -------- | ---------------- | ------------------------------ |
| 0    | 理论可行 | 需要极端条件     | 需要物理访问+时间窗口+特定版本 |
| 2    | 困难     | 需要专业技能     | 复杂的内存溢出利用             |
| 4    | 中等     | 需要一些技术知识 | 需要构造特定 payload           |
| 7    | 容易     | 可编程利用       | 公开 PoC 可直接使用            |
| 9    | 自动化   | 工具一键利用     | Metasploit 模块可用            |

### 2.3 认知程度 (Awareness)

该问题的知名度。

| 分数 | 等级 | 描述                 | 软件项目示例       |
| ---- | ---- | -------------------- | ------------------ |
| 0    | 未知 | 仅内部少数人知晓     | 内部发现的 0day    |
| 2    | 隐藏 | 需要主动搜索才能发现 | 安全公告未广泛传播 |
| 5    | 明显 | 行业内知晓           | 安全会议披露       |
| 7    | 公开 | 媒体报道             | 重大安全事件新闻   |
| 9    | 常识 | 广为人知的常见问题   | OWASP Top 10       |

### 2.4 入侵检测 (Intrusion Detection)

检测到攻击或问题发生的能力。

| 分数 | 等级     | 描述                 | 软件项目示例    |
| ---- | -------- | -------------------- | --------------- |
| 0    | 主动检测 | 实时告警+自动响应    | SIEM + 自动封禁 |
| 2    | 有日志   | 有完整日志可事后分析 | 详细审计日志    |
| 5    | 偶尔日志 | 部分操作有记录       | 仅错误日志      |
| 7    | 最小日志 | 基本日志记录         | 仅访问日志      |
| 9    | 无日志   | 完全无法追踪         | 无任何监控      |

## 3. 评分示例

### 示例 1：SQL 注入风险

```yaml
risk_id: R-001
scenario: 用户搜索框存在 SQL 注入漏洞

threat_agent_factors:
  skill_level: 5 # 中级 - 需要了解 SQL 语法
  motive: 6 # 高回报 - 可获取数据库数据
  opportunity: 9 # 无需访问 - 公开搜索功能
  size: 9 # 全球 - 任何人可尝试
  average: 7.25

vulnerability_factors:
  ease_of_discovery: 7 # 自动化工具可发现
  ease_of_exploit: 7 # 容易 - 有公开 PoC
  awareness: 9 # 常识 - OWASP Top 10
  intrusion_detection: 5 # 偶尔日志 - 仅错误日志
  average: 7.0

likelihood: 7.125 # (7.25 + 7.0) / 2
likelihood_level: HIGH
```

### 示例 2：内部配置错误风险

```yaml
risk_id: R-002
scenario: 开发环境配置意外部署到生产环境

threat_agent_factors:
  skill_level: 1 # 初学者 - 无需技术知识
  motive: 4 # 可能有益 - 调试信息泄露
  opportunity: 4 # 部分访问 - 需要知道 URL
  size: 6 # 大型群体 - 自动化扫描
  average: 3.75

vulnerability_factors:
  ease_of_discovery: 7 # 自动化工具 - 可扫描出调试页面
  ease_of_exploit: 9 # 自动化 - 直接访问即可
  awareness: 7 # 公开 - 常见配置问题
  intrusion_detection: 7 # 最小日志 - 正常访问无告警
  average: 7.5

likelihood: 5.625 # (3.75 + 7.5) / 2
likelihood_level: MEDIUM
```

## 4. 评估检查清单

### 威胁代理评估问题

- [ ] 谁可能触发这个问题？
- [ ] 他们需要什么技术能力？
- [ ] 他们能获得什么好处？
- [ ] 获取必要权限有多难？
- [ ] 有多少人可能尝试？

### 漏洞评估问题

- [ ] 问题容易被发现吗？
- [ ] 利用问题需要什么条件？
- [ ] 这是已知问题还是新问题？
- [ ] 我们能检测到问题被利用吗？

## 5. 快速评估卡

| 分数 | Likelihood 等级 | 典型场景                   |
| ---- | --------------- | -------------------------- |
| 7-9  | HIGH            | 公开漏洞、自动化可利用     |
| 4-6  | MEDIUM          | 需要特定条件、有一定门槛   |
| 0-3  | LOW             | 需要内部访问、复杂利用条件 |
