---
name: context-researcher
description: |
  ã€è§¦å‘æ¡ä»¶ã€‘è§„åˆ’å·¥ä½œæµç¬¬äºŒæ­¥ï¼šåŸºäºå¤§çº²æ”¶é›†ä»£ç åº“ä¸Šä¸‹æ–‡å’Œç´ æã€‚
  ã€æ ¸å¿ƒäº§å‡ºã€‘è¾“å‡º ${run_dir}/materials.mdï¼ŒåŒ…å«ç›¸å…³ä»£ç ã€æ¶æ„å’Œä¾èµ–ã€‚
  ã€ä¸è§¦å‘ã€‘ä»»åŠ¡è§„åˆ’ï¼ˆç”¨ task-plannerï¼‰ã€å†…å®¹ç¼–å†™ï¼ˆç”¨ content-writerï¼‰ã€‚
allowed-tools: Read, Grep, Glob, LSP, mcp__auggie-mcp__codebase-retrieval
arguments:
  - name: run_dir
    type: string
    required: true
    description: è¿è¡Œç›®å½•è·¯å¾„ï¼ˆç”± orchestrator ä¼ å…¥ï¼‰
---

# Context Researcher - ç´ æç ”ç©¶åŸå­æŠ€èƒ½

## èŒè´£è¾¹ç•Œ

- **è¾“å…¥**: `${run_dir}` + `${run_dir}/outline.md` æ–‡ä»¶è·¯å¾„
- **è¾“å‡º**: `${run_dir}/materials.md`
- **å•ä¸€èŒè´£**: åªåšä¸Šä¸‹æ–‡æ”¶é›†å’Œç´ ææ•´ç†ï¼Œä¸åšè§„åˆ’æˆ–ç¼–å†™

## æ‰§è¡Œæµç¨‹

### Step 1: è¯»å–å¤§çº²

```bash
è¯»å– ${run_dir}/outline.md
æå–: å­ä»»åŠ¡åˆ—è¡¨ã€å…³é”®è·¯å¾„ã€æ¶‰åŠçš„æ¨¡å—
```

### Step 2: ä»£ç æ£€ç´¢

ä½¿ç”¨ `mcp__auggie-mcp__codebase-retrieval` è¿›è¡Œè¯­ä¹‰æ£€ç´¢ï¼š

```
information_request: "åŸºäºä»¥ä¸‹å¤§çº²ï¼ŒæŸ¥æ‰¾ç›¸å…³ä»£ç ã€æ¶æ„å’Œä¾èµ–:

## ç›®æ ‡
<å¤§çº²ä¸­çš„ç›®æ ‡>

## å­ä»»åŠ¡
<å­ä»»åŠ¡åˆ—è¡¨>

éœ€è¦æŸ¥æ‰¾:
1. ç›¸å…³çš„ç°æœ‰å®ç°
2. å¯å¤ç”¨çš„æ¨¡å—å’Œå‡½æ•°
3. æ•°æ®æ¨¡å‹å’Œæ¥å£å®šä¹‰
4. é…ç½®æ–‡ä»¶å’Œä¾èµ–
"
```

### Step 3: ç¬¦å·åˆ†æ

ä½¿ç”¨ LSP è¿›è¡Œç²¾å‡†ç¬¦å·åˆ†æï¼š

```bash
# å¯¹å…³é”®æ–‡ä»¶
LSP documentSymbol <file> # è·å–æ–‡ä»¶ç»“æ„

# å¯¹å…³é”®ç¬¦å·
LSP goToDefinition <symbol> # å®šä½å®šä¹‰
LSP findReferences <symbol> # æŸ¥æ‰¾å¼•ç”¨
LSP hover <symbol> # è·å–ç±»å‹ä¿¡æ¯
```

### Step 4: çº¦æŸæç‚¼

æ•´ç†æŠ€æœ¯çº¦æŸï¼š

- æŠ€æœ¯æ ˆç‰ˆæœ¬
- ç°æœ‰æ¶æ„æ¨¡å¼
- ä¾èµ–å…³ç³»
- å‘½åè§„èŒƒ
- ä»£ç é£æ ¼

### Step 5: è¾“å‡ºç´ æåº“

å°†ç»“æœå†™å…¥ `${run_dir}/materials.md`ï¼š

````markdown
# ç´ æåº“: <ä»»åŠ¡å>

## å…ƒä¿¡æ¯

- åŸºäºå¤§çº²: outline.md
- æ”¶é›†æ—¶é—´: [timestamp]
- æ£€ç´¢æ–‡ä»¶æ•°: X

## ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶       | ç±»å‹     | ç›¸å…³åº¦ | è¯´æ˜     |
| ---------- | -------- | ------ | -------- |
| src/foo.ts | æ ¸å¿ƒå®ç° | é«˜     | éœ€è¦ä¿®æ”¹ |
| src/bar.ts | ä¾èµ–     | ä¸­     | éœ€è¦äº†è§£ |

## å…³é”®ç¬¦å·

### æ¥å£å®šä¹‰

```typescript
// src/types/user.ts:10
interface User {
  id: string;
  name: string;
  // ...
}
```
````

### æ ¸å¿ƒå‡½æ•°

```typescript
// src/services/auth.ts:25
async function authenticate(credentials: Credentials): Promise<User>;
```

## ç°æœ‰æ¨¡å¼

### æ¶æ„æ¨¡å¼

- åˆ†å±‚æ¶æ„: Controller â†’ Service â†’ Repository
- ä¾èµ–æ³¨å…¥: ä½¿ç”¨ @inject è£…é¥°å™¨
- é”™è¯¯å¤„ç†: ç»Ÿä¸€ AppError ç±»

### å‘½åè§„èŒƒ

- æ–‡ä»¶: kebab-case
- ç±»: PascalCase
- å‡½æ•°: camelCase
- å¸¸é‡: UPPER_SNAKE_CASE

## æŠ€æœ¯çº¦æŸ

| çº¦æŸ       | å€¼         | å½±å“             |
| ---------- | ---------- | ---------------- |
| Node ç‰ˆæœ¬  | 18.x       | å¯ç”¨ ES2022 ç‰¹æ€§ |
| TypeScript | 5.x        | ä¸¥æ ¼æ¨¡å¼         |
| æ•°æ®åº“     | PostgreSQL | äº‹åŠ¡æ”¯æŒ         |

## ä¾èµ–å…³ç³»å›¾

```
UserController
    â””â”€â”€ UserService
        â”œâ”€â”€ UserRepository
        â””â”€â”€ AuthService
            â””â”€â”€ TokenService
```

---

ä¸‹ä¸€æ­¥: è°ƒç”¨ content-writer ç¼–å†™ç« èŠ‚

```

## è¿”å›å€¼

æ‰§è¡Œå®Œæˆåï¼Œè¿”å›ï¼š

```

ç´ æç ”ç©¶å®Œæˆã€‚
è¾“å‡ºæ–‡ä»¶: ${run_dir}/materials.md

ğŸ“š ç´ ææ¦‚è¦:

- ç›¸å…³æ–‡ä»¶: X ä¸ª
- å…³é”®ç¬¦å·: Y ä¸ª
- æ¶æ„æ¨¡å¼: Z ç§

ä¸‹ä¸€æ­¥: ä½¿ç”¨ /planning:content-writer ç¼–å†™ç« èŠ‚

```

## è´¨é‡é—¨æ§ (Gate 2)

| ç»´åº¦ | æ ‡å‡† | é˜ˆå€¼ |
|------|------|------|
| å®Œæ•´æ€§ | æ˜¯å¦è¦†ç›–å¤§çº²æ‰€éœ€çš„æ‰€æœ‰æ¨¡å— | â‰¥4/5 |
| å‡†ç¡®æ€§ | æ–‡ä»¶è·¯å¾„å’Œç¬¦å·æ˜¯å¦æ­£ç¡® | â‰¥4/5 |
| ç›¸å…³æ€§ | æ˜¯å¦èšç„¦äºä»»åŠ¡éœ€æ±‚ | â‰¥4/5 |

- è¯„åˆ† â‰¥ 4: é€šè¿‡ï¼Œç»§ç»­ä¸‹ä¸€é˜¶æ®µ
- è¯„åˆ† < 4: è¡¥å……ç ”ç©¶
- è¿­ä»£ > 3: è§¦å‘æ–­è·¯å™¨

## çº¦æŸ

- ä¸åšä»»åŠ¡è§„åˆ’ï¼ˆäº¤ç»™ task-plannerï¼‰
- ä¸åšå†…å®¹ç¼–å†™ï¼ˆäº¤ç»™ content-writerï¼‰
- å¿…é¡»ä½¿ç”¨ LSP éªŒè¯ç¬¦å·å­˜åœ¨
- æ–‡ä»¶è·¯å¾„å¿…é¡»å¯éªŒè¯
```
