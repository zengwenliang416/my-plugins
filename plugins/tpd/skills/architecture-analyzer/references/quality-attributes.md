# 质量属性场景

## 概述

本文档定义了软件架构中常见的质量属性及其评估场景。

## 质量属性分类

### ISO 25010 质量模型

```
                        软件产品质量
                            │
    ┌───────┬───────┬───────┼───────┬───────┬───────┬───────┐
    │       │       │       │       │       │       │       │
 功能性  性能效率  兼容性  易用性  可靠性  安全性  可维护性  可移植性
```

| 属性     | 子属性                                         | 描述               |
| -------- | ---------------------------------------------- | ------------------ |
| 功能性   | 完备性、正确性、适合性                         | 满足功能需求的程度 |
| 性能效率 | 时间行为、资源利用、容量                       | 资源使用效率       |
| 兼容性   | 共存性、互操作性                               | 与其他系统协作能力 |
| 易用性   | 可学习性、可操作性、错误保护                   | 用户使用体验       |
| 可靠性   | 成熟性、可用性、容错性、可恢复性               | 系统稳定运行能力   |
| 安全性   | 保密性、完整性、不可否认性、真实性             | 信息保护能力       |
| 可维护性 | 模块化、可重用性、可分析性、可修改性、可测试性 | 系统维护成本       |
| 可移植性 | 适应性、可安装性、可替换性                     | 环境迁移能力       |

## 质量属性场景模板

### 通用格式

```
Source → Stimulus → Artifact → Environment → Response → Response Measure
```

| 元素             | 描述       | 示例                       |
| ---------------- | ---------- | -------------------------- |
| Source           | 刺激来源   | 用户、外部系统、定时器     |
| Stimulus         | 触发事件   | 请求、故障、攻击           |
| Artifact         | 受影响组件 | 系统、进程、数据           |
| Environment      | 运行环境   | 正常运行、高负载、降级模式 |
| Response         | 系统响应   | 处理请求、记录日志、通知   |
| Response Measure | 度量指标   | 时间、百分比、数量         |

## 性能场景

### 响应时间

| 场景 ID  | 描述              | 度量        |
| -------- | ----------------- | ----------- |
| PERF-001 | 普通用户登录请求  | P95 < 200ms |
| PERF-002 | 列表查询（100条） | P95 < 500ms |
| PERF-003 | 文件上传（10MB）  | P95 < 3s    |
| PERF-004 | 报表生成          | P95 < 10s   |

### 吞吐量

| 场景 ID  | 描述             | 度量           |
| -------- | ---------------- | -------------- |
| PERF-010 | API 网关处理能力 | >= 10,000 RPS  |
| PERF-011 | 消息队列处理     | >= 5,000 msg/s |
| PERF-012 | 数据库写入       | >= 1,000 TPS   |

### 资源利用

| 场景 ID  | 描述         | 度量  |
| -------- | ------------ | ----- |
| PERF-020 | 正常负载 CPU | < 60% |
| PERF-021 | 正常负载内存 | < 70% |
| PERF-022 | 高峰期 CPU   | < 85% |

### 场景模板

```markdown
### PERF-XXX: [场景名称]

**Source**: [用户/系统/定时器]
**Stimulus**: [具体操作]
**Environment**: [正常/高负载/降级]
**Response**: [处理方式]
**Measure**:

- P50: xxx
- P95: xxx
- P99: xxx
```

## 可用性场景

### 正常运行时间

| 场景 ID   | 描述             | 度量                  |
| --------- | ---------------- | --------------------- |
| AVAIL-001 | 核心服务可用性   | 99.9% (8.76h 停机/年) |
| AVAIL-002 | 非核心服务可用性 | 99.5% (43.8h 停机/年) |
| AVAIL-003 | 计划维护窗口     | 每月 4h               |

### 故障恢复

| 场景 ID   | 描述           | 度量   |
| --------- | -------------- | ------ |
| AVAIL-010 | 单节点故障恢复 | < 30s  |
| AVAIL-011 | 数据库主从切换 | < 60s  |
| AVAIL-012 | 跨区域故障转移 | < 5min |

### RTO/RPO

| 场景 ID   | 描述         | RTO | RPO    |
| --------- | ------------ | --- | ------ |
| AVAIL-020 | 核心业务系统 | 1h  | 5min   |
| AVAIL-021 | 报表系统     | 4h  | 24h    |
| AVAIL-022 | 日志系统     | 8h  | 可丢失 |

## 安全性场景

### 认证授权

| 场景 ID | 描述         | 度量                            |
| ------- | ------------ | ------------------------------- |
| SEC-001 | 登录失败锁定 | 5 次失败后锁定 15min            |
| SEC-002 | 会话超时     | 30min 无操作自动登出            |
| SEC-003 | 密码复杂度   | >= 8 字符，含大小写数字特殊符号 |
| SEC-004 | MFA 要求     | 敏感操作强制 MFA                |

### 数据保护

| 场景 ID | 描述         | 度量                 |
| ------- | ------------ | -------------------- |
| SEC-010 | 传输加密     | TLS 1.2+             |
| SEC-011 | 静态加密     | AES-256              |
| SEC-012 | 敏感数据脱敏 | 日志中无明文敏感信息 |
| SEC-013 | 密钥轮换     | 每 90 天             |

### 攻击防护

| 场景 ID | 描述          | 度量                 |
| ------- | ------------- | -------------------- |
| SEC-020 | SQL 注入防护  | 0 漏洞               |
| SEC-021 | XSS 防护      | 0 漏洞               |
| SEC-022 | CSRF 防护     | 所有变更操作有 Token |
| SEC-023 | Rate Limiting | 100 req/min/IP       |

## 可维护性场景

### 模块化

| 场景 ID   | 描述       | 度量                      |
| --------- | ---------- | ------------------------- |
| MAINT-001 | 模块耦合度 | 循环依赖 = 0              |
| MAINT-002 | 模块内聚度 | LCOM < 0.5                |
| MAINT-003 | 接口稳定性 | Breaking changes < 1/季度 |

### 可测试性

| 场景 ID   | 描述           | 度量            |
| --------- | -------------- | --------------- |
| MAINT-010 | 单元测试覆盖率 | >= 80%          |
| MAINT-011 | 集成测试覆盖率 | >= 60%          |
| MAINT-012 | E2E 测试覆盖率 | 核心流程 100%   |
| MAINT-013 | 测试执行时间   | 单元测试 < 5min |

### 可修改性

| 场景 ID   | 描述         | 度量             |
| --------- | ------------ | ---------------- |
| MAINT-020 | 新功能开发   | 无需修改核心模块 |
| MAINT-021 | Bug 修复定位 | < 30min          |
| MAINT-022 | 技术栈升级   | 影响范围可控     |

## 可扩展性场景

### 水平扩展

| 场景 ID   | 描述           | 度量       |
| --------- | -------------- | ---------- |
| SCALE-001 | 无状态服务扩展 | 线性扩展   |
| SCALE-002 | 数据库读扩展   | 读副本支持 |
| SCALE-003 | 缓存扩展       | 集群模式   |

### 垂直扩展

| 场景 ID   | 描述         | 度量         |
| --------- | ------------ | ------------ |
| SCALE-010 | 单机资源上限 | 可配置       |
| SCALE-011 | 数据库资源   | 支持在线调整 |

### 弹性伸缩

| 场景 ID   | 描述         | 度量                 |
| --------- | ------------ | -------------------- |
| SCALE-020 | 自动扩容触发 | CPU > 70% 持续 5min  |
| SCALE-021 | 自动缩容触发 | CPU < 30% 持续 15min |
| SCALE-022 | 扩容速度     | 新实例 < 2min        |

## 可移植性场景

### 环境适应

| 场景 ID  | 描述       | 度量               |
| -------- | ---------- | ------------------ |
| PORT-001 | 容器化部署 | Docker 支持        |
| PORT-002 | 云平台无关 | 支持 AWS/Azure/GCP |
| PORT-003 | 数据库迁移 | 迁移脚本版本化     |

### 配置管理

| 场景 ID  | 描述         | 度量               |
| -------- | ------------ | ------------------ |
| PORT-010 | 环境配置分离 | 零代码修改切换环境 |
| PORT-011 | 功能开关     | 支持动态开关       |
| PORT-012 | 配置热更新   | 无需重启           |

## 场景优先级矩阵

根据业务重要性和技术风险确定优先级：

| 优先级 | 描述         | 示例场景             |
| ------ | ------------ | -------------------- |
| P0     | 核心业务必需 | 认证安全、数据完整性 |
| P1     | 重要但可降级 | 性能目标、高可用     |
| P2     | 期望达成     | 可维护性、可移植性   |
| P3     | 锦上添花     | 极限性能优化         |

## 质量属性权衡

常见权衡关系：

| 权衡             | 说明         |
| ---------------- | ------------ |
| 性能 vs 安全     | 加密降低性能 |
| 可用性 vs 一致性 | CAP 定理     |
| 可维护性 vs 性能 | 抽象层开销   |
| 安全 vs 易用性   | 更多验证步骤 |

## 输出格式

### 质量需求文档

```markdown
## 质量需求

### 性能需求

| ID       | 场景     | 目标        | 优先级 |
| -------- | -------- | ----------- | ------ |
| PERF-001 | 用户登录 | P95 < 200ms | P1     |

### 可用性需求

| ID        | 场景     | 目标  | 优先级 |
| --------- | -------- | ----- | ------ |
| AVAIL-001 | 核心服务 | 99.9% | P0     |

### 安全需求

| ID      | 场景     | 目标       | 优先级 |
| ------- | -------- | ---------- | ------ |
| SEC-001 | 认证安全 | 符合 OWASP | P0     |
```
