# WBS 工作分解结构指南

## 概述

工作分解结构（Work Breakdown Structure, WBS）是将项目可交付成果和项目工作分解成较小、更易管理的组件的层级分解。

## 核心原则

### 100% 规则

WBS 必须包含项目 100% 的工作，不多不少：

- **完整性**：所有工作都必须在 WBS 中有对应项
- **互斥性**：任务之间不能有重叠
- **无遗漏**：不能有"隐藏"的工作
- **层级一致**：同一层级的任务粒度应相近

### 可交付物导向

以交付物（Deliverable）为主线，而非活动（Activity）：

| 推荐（交付物导向） | 不推荐（活动导向） |
| ------------------ | ------------------ |
| 用户认证模块       | 编写认证代码       |
| API 文档           | 撰写文档           |
| 单元测试套件       | 执行测试           |
| 数据库迁移脚本     | 迁移数据库         |

### 8/80 规则

任务粒度控制：

- **最小**：不少于 8 小时（约 1 个工作日）
- **最大**：不超过 80 小时（约 2 周）
- **推荐**：1-4 小时为开发任务的理想粒度

## WBS 层级结构

```
项目（Level 0）
├── 阶段/模块（Level 1）
│   ├── 工作包（Level 2）
│   │   ├── 任务（Level 3）
│   │   │   └── 子任务（Level 4）
```

### 层级定义

| 层级 | 名称   | 描述               | 示例         |
| ---- | ------ | ------------------ | ------------ |
| L0   | 项目   | 项目整体           | 用户管理系统 |
| L1   | 阶段   | 主要阶段或模块     | 认证模块     |
| L2   | 工作包 | 可分配的工作单元   | 登录功能     |
| L3   | 任务   | 具体可执行任务     | 实现登录 API |
| L4   | 子任务 | 任务的细分（可选） | 编写验证逻辑 |

## 任务命名规范

### 格式

```
[动词] + [对象] + [限定词（可选）]
```

### 动词推荐

| 类型 | 推荐动词                          |
| ---- | --------------------------------- |
| 创建 | Create, Implement, Build, Design  |
| 修改 | Update, Modify, Refactor, Enhance |
| 移除 | Remove, Delete, Deprecate         |
| 测试 | Test, Validate, Verify            |
| 文档 | Document, Write, Describe         |
| 配置 | Configure, Setup, Initialize      |
| 集成 | Integrate, Connect, Sync          |
| 优化 | Optimize, Improve, Tune           |

### 示例

```markdown
✅ 推荐：

- Create user authentication API endpoint
- Implement JWT token validation middleware
- Write unit tests for login service
- Configure CI/CD pipeline for staging

❌ 避免：

- Do authentication stuff
- Fix bugs
- Misc improvements
- TBD
```

## 任务分解检查清单

### 分解前检查

- [ ] 需求是否明确？
- [ ] 验收标准是否清晰？
- [ ] 依赖关系是否已识别？
- [ ] 是否有技术不确定性需要 spike？

### 分解后检查

- [ ] 是否符合 100% 规则？
- [ ] 每个任务是否有明确的交付物？
- [ ] 任务粒度是否合适（1-4 小时）？
- [ ] 是否可以独立验证每个任务？
- [ ] 是否有循环依赖？

## 全栈任务分解策略

### Contract-First 策略

```
1. 定义 API 接口契约（TypeScript Types / OpenAPI）
   ↓
2. 创建 Mock 数据（允许前端立即开始）
   ↓
3. 并行开发：
   - 后端：实现真实 API
   - 前端：使用 Mock 开发 UI
   ↓
4. 集成联调（切换 Mock → 真实 API）
   ↓
5. E2E 测试验证
```

### 前后端分解映射

| 后端任务      | 对应前端任务         | 依赖关系   |
| ------------- | -------------------- | ---------- |
| 设计 API 接口 | 定义 TypeScript 类型 | 并行       |
| 实现 API 端点 | 实现 API 调用层      | 前端等后端 |
| 编写 API 文档 | 创建 Mock 数据       | 并行       |
| 实现业务逻辑  | 实现 UI 组件         | 可并行     |
| 集成测试      | 组件测试             | 并行       |
| -             | E2E 测试             | 等后端     |

### 示例分解

**需求**：实现用户登录功能

```yaml
用户登录功能:
  阶段1_基础设施（无依赖）:
    - T-001: 设计登录 API 接口契约
    - T-002: 创建用户表迁移脚本
    - T-003: 配置 JWT 密钥管理

  阶段2_后端实现（依赖阶段1）:
    - T-004: 实现用户验证服务
    - T-005: 实现登录 API 端点
    - T-006: 添加 Rate Limiting

  阶段3_前端实现（依赖 T-001）:
    - T-007: 创建登录表单组件
    - T-008: 实现认证状态管理
    - T-009: 添加表单验证

  阶段4_集成（依赖阶段2、3）:
    - T-010: 前后端联调
    - T-011: 编写 E2E 测试
    - T-012: 安全审查
```

## 任务属性定义

每个任务应包含：

| 属性     | 描述                   | 必填 |
| -------- | ---------------------- | ---- |
| ID       | 唯一标识               | ✅   |
| 名称     | 任务名称               | ✅   |
| 类型     | frontend/backend/infra | ✅   |
| 复杂度   | 1-5 分                 | ✅   |
| 预估工时 | 小时数                 | ✅   |
| 依赖     | 前置任务 ID 列表       | ✅   |
| 输入     | 需要的前置条件         | ✅   |
| 输出     | 可交付物               | ✅   |
| 验收标准 | 完成标准               | ✅   |
| 分配者   | 负责人                 | 可选 |
| 风险     | 潜在风险               | 可选 |

## 复杂度评估

### 评估维度

| 维度       | 1 分     | 3 分     | 5 分       |
| ---------- | -------- | -------- | ---------- |
| 技术难度   | 常规实现 | 需要研究 | 前沿/未知  |
| 代码量     | < 100 行 | 100-500  | > 500 行   |
| 依赖复杂度 | 无外部   | 少量依赖 | 多外部依赖 |
| 测试难度   | 单元测试 | 集成测试 | E2E 测试   |
| 风险程度   | 低风险   | 中风险   | 高风险     |

### 工时估算公式

```
预估工时 = 基础工时 × 复杂度系数 × 不确定性系数

基础工时参考：
- 简单 CRUD API: 2h
- 复杂业务逻辑: 4h
- UI 组件: 2h
- 复杂交互组件: 4h

复杂度系数：1.0 / 1.5 / 2.0 / 2.5 / 3.0

不确定性系数：
- 熟悉领域: 1.0
- 部分熟悉: 1.3
- 不熟悉: 1.5
```

## 迭代分解

### Sprint 规划

```
Sprint 容量 = 团队人数 × 工作日 × 生产率系数

生产率系数：
- 成熟团队: 0.7
- 新团队: 0.5
- 有大量会议: 0.4
```

### 优先级排序

使用 MoSCoW 方法：

| 优先级      | 含义     | 占比建议 |
| ----------- | -------- | -------- |
| Must Have   | 必须完成 | 60%      |
| Should Have | 应该完成 | 20%      |
| Could Have  | 可以完成 | 15%      |
| Won't Have  | 本次不做 | 5%       |

## 输出格式

### WBS 文档结构

```markdown
# WBS - [项目名称]

## 元信息

- 项目: xxx
- 版本: 1.0
- 日期: YYYY-MM-DD

## 层级结构

[Mermaid 或 树形图]

## 任务清单

| ID    | 名称 | 类型 | 复杂度 | 预估 | 依赖 |
| ----- | ---- | ---- | ------ | ---- | ---- |
| T-001 | ...  | ...  | ...    | ...  | ...  |

## 阶段划分

### 阶段 1: [名称]

- 目标: ...
- 任务: T-001, T-002, ...
- 里程碑: ...

## 关键路径

[关键路径任务序列]

## 风险任务

[高风险任务及应对策略]
```
