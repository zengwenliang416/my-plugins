# WBS 工作分解结构模板
# 使用 YAML 格式定义层级结构

version: "1.0"
project:
  id: "{{project_id}}"
  name: "{{project_name}}"
  description: "{{project_description}}"
  created_at: "{{created_at}}"
  task_type: "{{task_type}}" # frontend | backend | fullstack

# WBS 层级结构
wbs:
  # Level 1: 阶段
  phases:
    - id: "P1"
      name: "基础设施"
      description: "项目基础设施搭建"
      order: 1
      dependencies: []

      # Level 2: 工作包
      work_packages:
        - id: "WP1.1"
          name: "数据库设计"
          description: "数据模型和迁移脚本"

          # Level 3: 任务
          tasks:
            - id: "T-001"
              name: "创建数据库迁移脚本"
              type: "backend"
              complexity: 3
              estimated_hours: 2
              depends_on: []
              inputs:
                - "需求文档"
                - "数据模型设计"
              outputs:
                - "迁移脚本文件"
                - "回滚脚本"
              acceptance_criteria:
                - "迁移脚本可重复执行"
                - "回滚脚本验证通过"
              priority: "must"
              risks: []

    - id: "P2"
      name: "核心功能"
      description: "核心业务功能实现"
      order: 2
      dependencies: ["P1"]

      work_packages:
        - id: "WP2.1"
          name: "后端 API"
          description: "RESTful API 实现"

          tasks:
            - id: "T-002"
              name: "实现认证 API"
              type: "backend"
              complexity: 4
              estimated_hours: 4
              depends_on: ["T-001"]
              inputs:
                - "API 接口契约"
                - "数据库表结构"
              outputs:
                - "认证 API 端点"
                - "API 测试"
              acceptance_criteria:
                - "API 符合接口契约"
                - "单元测试覆盖率 > 80%"
                - "通过安全扫描"
              priority: "must"
              risks:
                - "JWT 密钥管理复杂"

        - id: "WP2.2"
          name: "前端组件"
          description: "UI 组件开发"

          tasks:
            - id: "T-003"
              name: "创建登录表单组件"
              type: "frontend"
              complexity: 2
              estimated_hours: 2
              depends_on: []
              inputs:
                - "设计稿"
                - "TypeScript 类型定义"
              outputs:
                - "登录表单组件"
                - "组件测试"
              acceptance_criteria:
                - "符合设计稿"
                - "表单验证完整"
                - "响应式适配"
              priority: "must"
              risks: []

    - id: "P3"
      name: "集成测试"
      description: "前后端集成和测试"
      order: 3
      dependencies: ["P2"]

      work_packages:
        - id: "WP3.1"
          name: "E2E 测试"
          description: "端到端测试"

          tasks:
            - id: "T-004"
              name: "编写 E2E 测试用例"
              type: "test"
              complexity: 3
              estimated_hours: 3
              depends_on: ["T-002", "T-003"]
              inputs:
                - "功能需求"
                - "API 文档"
              outputs:
                - "E2E 测试脚本"
                - "测试报告"
              acceptance_criteria:
                - "核心流程覆盖"
                - "测试可重复执行"
              priority: "should"
              risks: []

# 里程碑定义
milestones:
  - id: "M1"
    name: "基础设施就绪"
    phase: "P1"
    tasks: ["T-001"]
    criteria: "数据库迁移完成，环境可用"

  - id: "M2"
    name: "API 可用"
    phase: "P2"
    tasks: ["T-002"]
    criteria: "认证 API 通过测试"

  - id: "M3"
    name: "功能完成"
    phase: "P3"
    tasks: ["T-003", "T-004"]
    criteria: "E2E 测试全部通过"

# 关键路径（自动计算）
critical_path:
  tasks: ["T-001", "T-002", "T-004"]
  total_hours: 9

# 资源统计
statistics:
  total_tasks: 4
  total_hours: 11
  by_type:
    backend: { count: 2, hours: 6 }
    frontend: { count: 1, hours: 2 }
    test: { count: 1, hours: 3 }
  by_priority:
    must: 3
    should: 1
    could: 0
    wont: 0
