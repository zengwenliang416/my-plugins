# Estimation Guidelines

估算规则，用于任务工作量评估和时间规划。

## 1. 估算原则

### 1.1 核心原则

1. **不预测时间**：只评估复杂度，不承诺完成时间
2. **相对估算**：使用相对复杂度而非绝对时间
3. **历史参考**：基于类似任务的历史数据
4. **团队共识**：估算结果需团队认可

### 1.2 估算粒度

| 级别    | 适用范围     | 精度要求 |
| ------- | ------------ | -------- |
| Epic    | 大功能模块   | 宽泛范围 |
| Story   | 用户故事     | 中等精度 |
| Task    | 具体实施任务 | 较高精度 |
| Subtask | 任务细分步骤 | 最高精度 |

## 2. 复杂度评估

### 2.1 复杂度量表

| 分数 | 标签   | 描述                       |
| ---- | ------ | -------------------------- |
| 1    | 简单   | 明确的修改，无不确定性     |
| 2    | 较简单 | 小范围修改，少量不确定性   |
| 3    | 中等   | 多文件修改，需要设计思考   |
| 4    | 较复杂 | 涉及多组件，需要架构决策   |
| 5    | 复杂   | 高不确定性，需要探索和原型 |

### 2.2 复杂度因素

#### 技术复杂度

| 因素       | 低 (1) | 中 (2) | 高 (3)  |
| ---------- | ------ | ------ | ------- |
| 代码行数   | < 50   | 50-200 | > 200   |
| 文件数量   | 1-2    | 3-5    | > 5     |
| 依赖组件   | 0-1    | 2-3    | > 3     |
| 算法复杂度 | O(n)   | O(n²)  | > O(n²) |
| 并发/异步  | 无     | 简单   | 复杂    |

#### 领域复杂度

| 因素     | 低 (1) | 中 (2) | 高 (3) |
| -------- | ------ | ------ | ------ |
| 业务规则 | 明确   | 较复杂 | 复杂   |
| 数据模型 | 简单   | 中等   | 复杂   |
| 集成点   | 0-1    | 2-3    | > 3    |
| 合规要求 | 无     | 一般   | 严格   |

#### 不确定性

| 因素       | 低 (1) | 中 (2)   | 高 (3) |
| ---------- | ------ | -------- | ------ |
| 需求清晰度 | 明确   | 基本清晰 | 模糊   |
| 技术熟悉度 | 熟悉   | 一般     | 陌生   |
| 依赖稳定性 | 稳定   | 一般     | 不稳定 |
| 测试覆盖   | 完善   | 部分     | 缺失   |

### 2.3 复杂度计算

```
总复杂度 = (技术复杂度 + 领域复杂度 + 不确定性) / 3
```

## 3. 任务类型参考

### 3.1 后端任务

| 任务类型     | 典型复杂度 | 参考范围   |
| ------------ | ---------- | ---------- |
| CRUD API     | 2          | 单表操作   |
| 复杂查询 API | 3          | 多表关联   |
| 认证/授权    | 4          | JWT/OAuth  |
| 第三方集成   | 4          | 支付/通知  |
| 数据迁移     | 3-5        | 视数据量   |
| 性能优化     | 4          | 索引/缓存  |
| 安全修复     | 3-4        | 视漏洞类型 |

### 3.2 前端任务

| 任务类型   | 典型复杂度 | 参考范围      |
| ---------- | ---------- | ------------- |
| 静态页面   | 1          | 展示型        |
| 表单组件   | 2-3        | 验证/提交     |
| 列表/表格  | 2-3        | 分页/筛选     |
| 状态管理   | 3-4        | Context/Redux |
| 复杂交互   | 4          | 拖拽/动画     |
| 响应式适配 | 2-3        | 多端适配      |
| 国际化     | 3          | 多语言支持    |

### 3.3 全栈任务

| 任务类型     | 典型复杂度 | 参考范围   |
| ------------ | ---------- | ---------- |
| 完整功能模块 | 4-5        | 前后端联调 |
| 实时功能     | 4-5        | WebSocket  |
| 文件上传     | 3-4        | 存储/预览  |
| 搜索功能     | 3-4        | 全文检索   |
| 导出功能     | 2-3        | CSV/PDF    |

## 4. 风险调整

### 4.1 风险乘数

| 风险等级 | 乘数 | 适用场景             |
| -------- | ---- | -------------------- |
| 低风险   | 1.0  | 熟悉领域，低不确定性 |
| 中风险   | 1.3  | 部分不确定，需要验证 |
| 高风险   | 1.5  | 新技术，高不确定性   |
| 关键风险 | 2.0  | 探索性，可能需要重做 |

### 4.2 调整后复杂度

```
调整后复杂度 = 基础复杂度 × 风险乘数
```

## 5. 历史数据参考

### 5.1 数据收集

每个完成的任务记录：

| 字段       | 描述           |
| ---------- | -------------- |
| 任务 ID    | 唯一标识       |
| 估算复杂度 | 初始估算       |
| 实际复杂度 | 完成后评估     |
| 任务类型   | 分类标签       |
| 影响因素   | 导致偏差的原因 |

### 5.2 校准周期

- 每周回顾估算准确性
- 每月更新参考基准
- 每季度校准估算模型

### 5.3 偏差分析

| 偏差范围 | 评价   | 行动           |
| -------- | ------ | -------------- |
| ±20%     | 准确   | 保持当前方法   |
| 20-50%   | 可接受 | 分析原因，微调 |
| > 50%    | 偏差大 | 重新评估方法   |

## 6. 估算输出格式

### 6.1 任务估算

```yaml
task_id: T-001
name: 实现用户登录 API
type: backend
complexity:
  technical: 2
  domain: 2
  uncertainty: 1
  base_score: 1.7
risk_multiplier: 1.0
final_score: 2
confidence: high
assumptions:
  - JWT 库已集成
  - 数据库 schema 已定义
```

### 6.2 总体估算

```yaml
plan_id: 20260119T100000Z
total_tasks: 12
complexity_distribution:
  simple: 3
  medium: 5
  complex: 4
total_complexity_points: 38
risk_adjusted_points: 45
confidence_level: medium
key_assumptions:
  - 无重大需求变更
  - 依赖服务稳定
```

## 7. 注意事项

### 7.1 常见陷阱

- **锚定效应**：不要被初始估算影响
- **乐观偏差**：倾向于低估复杂度
- **范围蔓延**：边界不清导致膨胀
- **知识诅咒**：专家低估新手难度

### 7.2 最佳实践

- 任务拆分到可估算粒度
- 多人独立估算后取平均
- 记录假设和不确定性
- 定期校准历史数据
- 接受估算是近似值
