---
name: test-case-designer
description: |
  ã€è§¦å‘æ¡ä»¶ã€‘æµ‹è¯•å·¥ä½œæµç¬¬äºŒæ­¥ï¼šåŸºäºåˆ†æç»“æœè®¾è®¡æµ‹è¯•ç”¨ä¾‹çŸ©é˜µã€‚
  ã€æ ¸å¿ƒäº§å‡ºã€‘è¾“å‡º ${run_dir}/test-cases.mdï¼ŒåŒ…å«æµ‹è¯•ç”¨ä¾‹è®¾è®¡å’ŒéªŒè¯æ–¹æ³•ã€‚
  ã€ä¸è§¦å‘ã€‘ä»£ç åˆ†æï¼ˆç”¨ test-analyzerï¼‰ã€æµ‹è¯•ç¼–å†™ï¼ˆç”¨ test-writerï¼‰ã€‚
allowed-tools: Read, Write, Bash, Task, Grep
arguments:
  - name: run_dir
    type: string
    required: true
    description: è¿è¡Œç›®å½•è·¯å¾„ï¼ˆç”± orchestrator ä¼ å…¥ï¼‰
  - name: model
    type: string
    required: false
    description: ä½¿ç”¨çš„æ¨¡å‹ï¼ˆcodex/geminiï¼‰ï¼Œç”¨äºå¹¶è¡Œè®¾è®¡
---

# Test Case Designer - æµ‹è¯•ç”¨ä¾‹è®¾è®¡åŸå­æŠ€èƒ½

## èŒè´£è¾¹ç•Œ

- **è¾“å…¥**: `${run_dir}` + `${run_dir}/analysis.md` æ–‡ä»¶è·¯å¾„
- **è¾“å‡º**:
  - å¹¶è¡Œæ¨¡å¼: `${run_dir}/test-cases-{codex|gemini}.md`
  - åˆå¹¶å: `${run_dir}/test-cases.md`
- **å•ä¸€èŒè´£**: åªåšç”¨ä¾‹è®¾è®¡ï¼Œä¸åšæµ‹è¯•ä»£ç ç¼–å†™

## æ‰§è¡Œæµç¨‹

### Step 1: è¯»å–åˆ†ææŠ¥å‘Š

```bash
è¯»å– ${run_dir}/analysis.md
æå–: å¯æµ‹è¯•æ¥å£ã€ä¼˜å…ˆçº§ã€ä¾èµ–å…³ç³»
```

### Step 2: åº”ç”¨æµ‹è¯•è®¾è®¡æ–¹æ³•

**å¹¶è¡Œè°ƒç”¨å¤–éƒ¨æ¨¡å‹**:

**Codex åˆ†æ (é€»è¾‘/è¾¹ç•Œè§†è§’)**:

è¾“å‡º: `${run_dir}/test-cases-codex.md`

```bash
~/.claude/bin/codeagent-wrapper codex \
  --role tester \
  --workdir $PROJECT_DIR \
  --prompt "åŸºäºä»¥ä¸‹åˆ†ææ–‡ä»¶ï¼Œè®¾è®¡æµ‹è¯•ç”¨ä¾‹:

åˆ†ææŠ¥å‘Šè·¯å¾„: ${run_dir}/analysis.md
è¯·å…ˆè¯»å–è¯¥æ–‡ä»¶ï¼Œç„¶ååŸºäºå†…å®¹è®¾è®¡æµ‹è¯•ç”¨ä¾‹ã€‚

è¦æ±‚:
1. ä½¿ç”¨ç­‰ä»·ç±»åˆ’åˆ†
2. ä½¿ç”¨è¾¹ç•Œå€¼åˆ†æ
3. è€ƒè™‘å¼‚å¸¸è·¯å¾„
4. æ¯ä¸ªç”¨ä¾‹æœ‰æ˜ç¡®çš„æœŸæœ›ç»“æœ

OUTPUT FORMAT:
## æµ‹è¯•ç”¨ä¾‹ (é€»è¾‘è§†è§’)
..."
```

**Gemini åˆ†æ (ç”¨æˆ·/åœºæ™¯è§†è§’)**:

è¾“å‡º: `${run_dir}/test-cases-gemini.md`

```bash
~/.claude/bin/codeagent-wrapper gemini \
  --role tester \
  --workdir $PROJECT_DIR \
  --prompt "åŸºäºä»¥ä¸‹åˆ†ææ–‡ä»¶ï¼Œè®¾è®¡æµ‹è¯•ç”¨ä¾‹:

åˆ†ææŠ¥å‘Šè·¯å¾„: ${run_dir}/analysis.md
è¯·å…ˆè¯»å–è¯¥æ–‡ä»¶ï¼Œå…³æ³¨ç”¨æˆ·åœºæ™¯ã€äº¤äº’æµç¨‹è®¾è®¡æµ‹è¯•ç”¨ä¾‹ã€‚"
```

### Step 3: æµ‹è¯•è®¾è®¡æ–¹æ³•

#### ç­‰ä»·ç±»åˆ’åˆ†

```markdown
è¾“å…¥: age (0-150 æœ‰æ•ˆ)

æœ‰æ•ˆç­‰ä»·ç±»:

- 0-17: æœªæˆå¹´
- 18-59: æˆå¹´
- 60-150: è€å¹´

æ— æ•ˆç­‰ä»·ç±»:

- < 0: è´Ÿæ•°
- > 150: è¶…å‡ºèŒƒå›´
- éæ•°å­—: ç±»å‹é”™è¯¯
```

#### è¾¹ç•Œå€¼åˆ†æ

```markdown
è¾¹ç•Œç‚¹: 0, 1, 17, 18, 59, 60, 149, 150, 151

æµ‹è¯•å€¼:

- age = -1 â†’ æ— æ•ˆ
- age = 0 â†’ æœ‰æ•ˆï¼ˆè¾¹ç•Œï¼‰
- age = 18 â†’ æœ‰æ•ˆï¼ˆæˆå¹´è¾¹ç•Œï¼‰
- age = 150 â†’ æœ‰æ•ˆï¼ˆè¾¹ç•Œï¼‰
- age = 151 â†’ æ— æ•ˆ
```

#### åœºæ™¯æµ‹è¯•

```markdown
åœºæ™¯: ç”¨æˆ·ç™»å½•

æ­£å¸¸æµç¨‹:

1. è¾“å…¥æ­£ç¡®ç”¨æˆ·åå¯†ç  â†’ ç™»å½•æˆåŠŸ
2. è®°ä½å¯†ç  â†’ è‡ªåŠ¨å¡«å……

å¼‚å¸¸æµç¨‹:

1. ç”¨æˆ·åä¸å­˜åœ¨ â†’ æç¤ºç”¨æˆ·ä¸å­˜åœ¨
2. å¯†ç é”™è¯¯ â†’ æç¤ºå¯†ç é”™è¯¯
3. è´¦æˆ·è¢«é”å®š â†’ æç¤ºè¢«é”å®š
```

### Step 4: ç»¼åˆç”¨ä¾‹è®¾è®¡

Claude ç»¼åˆä¸¤ä»½åˆ†æï¼š

1. **å»é‡åˆå¹¶** - ç›¸ä¼¼ç”¨ä¾‹åˆå¹¶
2. **å®Œå–„è¾¹ç•Œ** - è¡¥å……è¾¹ç•Œæ¡ä»¶
3. **æ’åº** - æŒ‰é‡è¦æ€§æ’åº
4. **è®¾è®¡éªŒè¯æ–¹æ³•** - æ¯ä¸ªç”¨ä¾‹æœ‰éªŒè¯æ­¥éª¤

### Step 5: è¾“å‡ºç”¨ä¾‹æŠ¥å‘Š

å†™å…¥ `${run_dir}/test-cases.md`ï¼š

```markdown
# æµ‹è¯•ç”¨ä¾‹è®¾è®¡: <ç›®æ ‡æ¨¡å—>

## å…ƒä¿¡æ¯

- åŸºäºåˆ†æ: analysis.md
- è®¾è®¡æ—¶é—´: [timestamp]
- åˆ†ææ¨¡å‹: Codex + Gemini

## æµ‹è¯•ç”¨ä¾‹çŸ©é˜µ

### createUser å‡½æ•°

| ID    | ç”¨ä¾‹åç§°      | è¾“å…¥                                   | æœŸæœ›è¾“å‡º        | ç±»å‹ |
| ----- | ------------- | -------------------------------------- | --------------- | ---- |
| TC001 | æ­£å¸¸åˆ›å»ºç”¨æˆ·  | {name: "Alice", email: "a@b.com"}      | User å¯¹è±¡       | æ­£å¸¸ |
| TC002 | é‚®ç®±ä¸ºç©º      | {name: "Alice", email: ""}             | ValidationError | å¼‚å¸¸ |
| TC003 | é‚®ç®±å·²å­˜åœ¨    | {name: "Bob", email: "existing@b.com"} | DuplicateError  | å¼‚å¸¸ |
| TC004 | åç§°è¾¹ç•Œ-ç©º   | {name: "", email: "a@b.com"}           | ValidationError | è¾¹ç•Œ |
| TC005 | åç§°è¾¹ç•Œ-æœ€å¤§ | {name: "A"\*256, email: "a@b.com"}     | ValidationError | è¾¹ç•Œ |

### calculateDiscount æ–¹æ³•

| ID    | ç”¨ä¾‹åç§°       | è¾“å…¥                           | æœŸæœ›è¾“å‡º | ç±»å‹ |
| ----- | -------------- | ------------------------------ | -------- | ---- |
| TC101 | æ™®é€šç”¨æˆ·æ— æŠ˜æ‰£ | membership="normal", total=100 | 0        | æ­£å¸¸ |
| TC102 | Gold ç”¨æˆ· 15%  | membership="gold", total=100   | 15       | æ­£å¸¸ |
| TC103 | è®¢å•é‡‘é¢ä¸º 0   | membership="gold", total=0     | 0        | è¾¹ç•Œ |
| TC104 | è´Ÿæ•°é‡‘é¢       | membership="gold", total=-100  | Error    | å¼‚å¸¸ |

## ç”¨ä¾‹è¯¦æƒ…

### TC001: æ­£å¸¸åˆ›å»ºç”¨æˆ·

**å‰ç½®æ¡ä»¶**: æ•°æ®åº“ä¸­æ— åŒåé‚®ç®±ç”¨æˆ·

**æµ‹è¯•æ­¥éª¤**:

1. å‡†å¤‡ç”¨æˆ·æ•°æ® {name: "Alice", email: "alice@example.com"}
2. è°ƒç”¨ createUser(userData)
3. éªŒè¯è¿”å› User å¯¹è±¡
4. éªŒè¯æ•°æ®åº“ä¸­å­˜åœ¨è¯¥ç”¨æˆ·

**é¢„æœŸç»“æœ**:

- è¿”å› User å¯¹è±¡
- user.id ä¸ä¸ºç©º
- user.createdAt ä¸ºå½“å‰æ—¶é—´

**Mock éœ€æ±‚**:

- Database: Fake (å†…å­˜æ•°æ®åº“)
- EmailService: Mock (éªŒè¯å‘é€æ¬¢è¿é‚®ä»¶)

---

### TC002: é‚®ç®±ä¸ºç©º

...

## æµ‹è¯•è¦†ç›–çŸ©é˜µ

| æ¥å£              | æ­£å¸¸ | å¼‚å¸¸ | è¾¹ç•Œ | æ€»è®¡ |
| ----------------- | ---- | ---- | ---- | ---- |
| createUser        | 1    | 2    | 2    | 5    |
| calculateDiscount | 2    | 1    | 2    | 5    |
| **æ€»è®¡**          | 3    | 3    | 4    | 10   |

---

ä¸‹ä¸€æ­¥: ä½¿ç”¨ testing:test-writer ç¼–å†™æµ‹è¯•ä»£ç 
```

## è¿”å›å€¼

```
æµ‹è¯•ç”¨ä¾‹è®¾è®¡å®Œæˆã€‚
è¾“å‡ºæ–‡ä»¶: ${run_dir}/test-cases.md

ğŸ“ ç”¨ä¾‹æ¦‚è¦:
- æ€»ç”¨ä¾‹æ•°: X
- æ­£å¸¸è·¯å¾„: Y
- å¼‚å¸¸è·¯å¾„: Z
- è¾¹ç•Œæ¡ä»¶: N

ä¸‹ä¸€æ­¥: ä½¿ç”¨ /testing:test-writer ç¼–å†™æµ‹è¯•ä»£ç 
```

## è´¨é‡é—¨æ§

| ç»´åº¦       | æ ‡å‡†                  | é˜ˆå€¼ |
| ---------- | --------------------- | ---- |
| ç”¨ä¾‹æ•°é‡   | æ¯ä¸ªæ¥å£æœ‰è¶³å¤Ÿç”¨ä¾‹    | â‰¥3   |
| è¦†ç›–ç±»å‹   | åŒ…å«æ­£å¸¸/å¼‚å¸¸/è¾¹ç•Œ    | âœ…   |
| åŒæ¨¡å‹è¦†ç›– | Codex + Gemini éƒ½åˆ†æ | âœ…   |
| éªŒè¯æ–¹æ³•   | æ¯ä¸ªç”¨ä¾‹æœ‰éªŒè¯æ­¥éª¤    | 100% |
