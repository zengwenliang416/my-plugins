{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "前端技术栈升级映射",
  "version": "1.0.0",
  "last_updated": "2025-01-13",
  "mappings": [
    {
      "from": {
        "framework": "React",
        "version": "17",
        "release_date": "2020-10-20"
      },
      "to": {
        "framework": "React",
        "version": "18",
        "release_date": "2022-03-29"
      },
      "strategy": "recommended",
      "effort": "low",
      "duration_weeks": 2,
      "breaking_changes": [
        {
          "category": "Root API",
          "description": "新的 createRoot API",
          "impact": "low",
          "code_example": {
            "before": "import ReactDOM from 'react-dom';\nReactDOM.render(<App />, document.getElementById('root'));",
            "after": "import { createRoot } from 'react-dom/client';\nconst root = createRoot(document.getElementById('root'));\nroot.render(<App />);"
          }
        },
        {
          "category": "自动批处理",
          "description": "所有更新自动批处理（包括异步）",
          "impact": "low",
          "benefit": "减少渲染次数，提升性能"
        },
        {
          "category": "TypeScript",
          "description": "children prop 不再隐式包含",
          "impact": "medium",
          "code_example": {
            "before": "interface Props { title: string }",
            "after": "interface Props { title: string; children?: React.ReactNode }"
          }
        }
      ],
      "new_features": [
        "Concurrent Rendering（并发渲染）",
        "Suspense for SSR",
        "useTransition / useDeferredValue",
        "Streaming SSR"
      ],
      "migration_tool": {
        "name": "React 18 codemod",
        "command": "npx react-codemod update-react-imports"
      }
    },
    {
      "from": {
        "framework": "Vue",
        "version": "2",
        "eol_date": "2023-12-31",
        "status": "end_of_life"
      },
      "to": {
        "framework": "Vue",
        "version": "3",
        "release_date": "2020-09-18"
      },
      "strategy": "required",
      "effort": "high",
      "duration_weeks": 8,
      "breaking_changes": [
        {
          "category": "全局 API",
          "description": "createApp 替代 new Vue()",
          "impact": "high",
          "code_example": {
            "before": "import Vue from 'vue';\nnew Vue({ render: h => h(App) }).$mount('#app');",
            "after": "import { createApp } from 'vue';\ncreateApp(App).mount('#app');"
          }
        },
        {
          "category": "过滤器",
          "description": "移除 filters 语法",
          "impact": "high",
          "solution": "使用计算属性或方法替代",
          "code_example": {
            "before": "{{ price | currency }}",
            "after": "{{ formatCurrency(price) }}"
          }
        },
        {
          "category": "生命周期",
          "description": "beforeDestroy → beforeUnmount, destroyed → unmounted",
          "impact": "medium"
        }
      ],
      "migration_tool": {
        "name": "Vue 3 Migration Build",
        "url": "https://v3-migration.vuejs.org/",
        "description": "提供兼容模式和运行时警告"
      }
    },
    {
      "from": {
        "framework": "Angular",
        "version": "15"
      },
      "to": {
        "framework": "Angular",
        "version": "17",
        "release_date": "2023-11-08"
      },
      "strategy": "recommended",
      "effort": "medium",
      "duration_weeks": 4,
      "new_features": [
        "Standalone Components（独立组件，无需 NgModule）",
        "Signals（新的响应式原语）",
        "Deferrable Views（@defer 懒加载）",
        "内置控制流（@if, @for）"
      ],
      "migration_path": [
        {
          "step": 1,
          "description": "ng update @angular/core@16 @angular/cli@16"
        },
        {
          "step": 2,
          "description": "ng update @angular/core@17 @angular/cli@17"
        },
        {
          "step": 3,
          "description": "迁移到 Standalone Components（可选）",
          "command": "ng generate @angular/core:standalone"
        }
      ]
    },
    {
      "from": {
        "bundler": "Webpack",
        "version": "4"
      },
      "to": {
        "bundler": "Webpack",
        "version": "5",
        "release_date": "2020-10-10"
      },
      "strategy": "recommended",
      "effort": "medium",
      "duration_weeks": 2,
      "breaking_changes": [
        {
          "category": "Node.js Polyfills",
          "description": "不再自动引入 Node.js polyfills",
          "impact": "high",
          "solution": "手动安装 polyfill 或使用 resolve.fallback",
          "code_example": {
            "webpack_config": "module.exports = {\n  resolve: {\n    fallback: {\n      \"buffer\": require.resolve(\"buffer/\"),\n      \"stream\": require.resolve(\"stream-browserify\")\n    }\n  }\n};"
          }
        }
      ],
      "benefits": [
        "构建速度提升 20-40%",
        "Tree shaking 改进",
        "模块联邦（Module Federation）"
      ]
    },
    {
      "from": {
        "bundler": "Webpack"
      },
      "to": {
        "bundler": "Vite",
        "version": "5",
        "release_date": "2023-11-16"
      },
      "strategy": "strategic",
      "effort": "high",
      "duration_weeks": 6,
      "advantages": [
        "开发服务器启动速度 100x",
        "HMR 更新速度 10x",
        "更简单的配置",
        "开箱即用的 TypeScript/JSX 支持"
      ],
      "migration_steps": [
        "替换 webpack.config.js → vite.config.js",
        "移除 webpack 插件，使用 Vite 插件",
        "调整 index.html 入口",
        "更新环境变量（VITE_ 前缀）"
      ]
    }
  ],
  "cross_framework_migrations": [
    {
      "from": {
        "framework": "jQuery"
      },
      "to": {
        "framework": "React",
        "version": "18"
      },
      "strategy": "strategic",
      "effort": "very_high",
      "duration_weeks": 24,
      "approach": "Strangler Fig Pattern",
      "steps": [
        "识别独立模块（表单、列表）",
        "用 React 重写独立模块",
        "使用 ReactDOM.render 嵌入到 jQuery 页面",
        "逐步扩大 React 覆盖范围",
        "最终移除 jQuery"
      ]
    }
  ],
  "tools": [
    {
      "name": "Codemod",
      "purpose": "自动化代码转换",
      "examples": ["react-codemod", "@vue/compat", "@angular/core:migrations"]
    },
    {
      "name": "Bundlephobia",
      "purpose": "分析 npm 包大小",
      "url": "https://bundlephobia.com/"
    },
    {
      "name": "webpack-bundle-analyzer",
      "purpose": "可视化打包产物",
      "command": "npm install --save-dev webpack-bundle-analyzer"
    }
  ],
  "common_pitfalls": [
    {
      "issue": "依赖版本冲突",
      "description": "React 18 需要 react-dom 18，但依赖包仍要求 17",
      "solution": "使用 npm overrides 或 yarn resolutions 强制版本"
    },
    {
      "issue": "性能回退",
      "description": "升级后包体积增加",
      "solution": "检查是否引入了不必要的 polyfill，使用 tree-shaking"
    }
  ]
}
