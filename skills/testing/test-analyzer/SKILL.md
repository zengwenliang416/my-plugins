---
name: test-analyzer
description: |
  ã€è§¦å‘æ¡ä»¶ã€‘æµ‹è¯•å·¥ä½œæµç¬¬ä¸€æ­¥ï¼šåˆ†æä»£ç ç»“æ„ï¼Œè¯†åˆ«å¯æµ‹è¯•æ¥å£ï¼Œè¯„ä¼°è¦†ç›–ç‡ç¼ºå£ã€‚
  ã€æ ¸å¿ƒäº§å‡ºã€‘è¾“å‡º ${run_dir}/analysis.mdï¼ŒåŒ…å«å¯æµ‹è¯•æ¥å£æ¸…å•å’Œè¦†ç›–ç‡åˆ†æã€‚
  ã€ä¸è§¦å‘ã€‘ç”¨ä¾‹è®¾è®¡ï¼ˆç”¨ test-case-designerï¼‰ã€æµ‹è¯•ç¼–å†™ï¼ˆç”¨ test-writerï¼‰ã€‚
allowed-tools: Read, Write, Bash, Grep, Glob, LSP, mcp__auggie-mcp__codebase-retrieval
arguments:
  - name: run_dir
    type: string
    required: true
    description: è¿è¡Œç›®å½•è·¯å¾„ï¼ˆç”± orchestrator ä¼ å…¥ï¼‰
---

# Test Analyzer - æµ‹è¯•åˆ†æåŸå­æŠ€èƒ½

## èŒè´£è¾¹ç•Œ

- **è¾“å…¥**: `${run_dir}` + ç›®æ ‡ä»£ç è·¯å¾„ + æµ‹è¯•æ¡†æ¶ + åˆ†ææ¨¡å¼
- **è¾“å‡º**: `${run_dir}/analysis.md`
- **å•ä¸€èŒè´£**: åªåšä»£ç åˆ†æå’Œæ¥å£è¯†åˆ«ï¼Œä¸åšç”¨ä¾‹è®¾è®¡

## æ‰§è¡Œæµç¨‹

### Step 1: ä»£ç ç»“æ„åˆ†æ

```bash
# ä½¿ç”¨ LSP è·å–æ–‡ä»¶ç¬¦å·
LSP documentSymbol <target_file>

# è·å–æ¨¡å—å…¬å¼€æ¥å£
LSP workspaceSymbol <module_name>
```

### Step 2: å¯æµ‹è¯•æ¥å£è¯†åˆ«

è¯†åˆ«ä»¥ä¸‹ç±»å‹çš„æ¥å£ï¼š

| ç±»å‹     | ç‰¹å¾          | æµ‹è¯•ä¼˜å…ˆçº§ |
| -------- | ------------- | ---------- |
| å…¬å¼€å‡½æ•° | export/public | é«˜         |
| ç±»æ–¹æ³•   | public method | é«˜         |
| API ç«¯ç‚¹ | route handler | é«˜         |
| å·¥å…·å‡½æ•° | è¢«å¤šå¤„å¼•ç”¨    | ä¸­         |
| ç§æœ‰æ–¹æ³• | private       | ä½         |

### Step 3: è¦†ç›–ç‡åˆ†æï¼ˆå¯é€‰ï¼‰

å¦‚æœå­˜åœ¨è¦†ç›–ç‡æŠ¥å‘Šï¼š

```bash
# è¯»å–è¦†ç›–ç‡æŠ¥å‘Š
Read coverage/lcov.info

# è¯†åˆ«æœªè¦†ç›–ä»£ç 
åˆ†ææœªè¦†ç›–è¡Œå· â†’ æ˜ å°„åˆ°å‡½æ•°
```

### Step 4: ä¾èµ–åˆ†æ

```bash
# åˆ†æä¾èµ–å…³ç³»
LSP incomingCalls <function>
LSP outgoingCalls <function>

# è¯†åˆ«éœ€è¦ Mock çš„å¤–éƒ¨ä¾èµ–
```

### Step 5: è¾“å‡ºåˆ†ææŠ¥å‘Š

å†™å…¥ `${run_dir}/analysis.md`ï¼š

```markdown
# æµ‹è¯•åˆ†ææŠ¥å‘Š: <ç›®æ ‡æ¨¡å—>

## å…ƒä¿¡æ¯

- ç›®æ ‡è·¯å¾„: [path]
- åˆ†ææ—¶é—´: [timestamp]
- æµ‹è¯•æ¡†æ¶: [jest|pytest|vitest|go]

## å¯æµ‹è¯•æ¥å£æ¸…å•

### é«˜ä¼˜å…ˆçº§

| æ¥å£              | ç±»å‹ | ä½ç½®                    | å¤æ‚åº¦ | ä¾èµ–      |
| ----------------- | ---- | ----------------------- | ------ | --------- |
| createUser        | å‡½æ•° | src/services/user.ts:25 | ä¸­     | DB, Email |
| calculateDiscount | æ–¹æ³• | src/models/order.ts:50  | ä½     | æ—         |

### ä¸­ä¼˜å…ˆçº§

...

### ä½ä¼˜å…ˆçº§

...

## è¦†ç›–ç‡åˆ†æ

| æ–‡ä»¶    | è¡Œè¦†ç›–ç‡ | åˆ†æ”¯è¦†ç›–ç‡ | ç¼ºå£               |
| ------- | -------- | ---------- | ------------------ |
| user.ts | 65%      | 50%        | lines 30-45, 60-70 |

## æœªè¦†ç›–å…³é”®è·¯å¾„

1. `createUser` å¼‚å¸¸å¤„ç†åˆ†æ”¯ (line 35-40)
2. `validateEmail` è¾¹ç•Œæ¡ä»¶ (line 60)

## Mock ä¾èµ–æ¸…å•

| ä¾èµ–         | ç±»å‹     | Mock ç­–ç•¥ |
| ------------ | -------- | --------- |
| Database     | å¤–éƒ¨æœåŠ¡ | Fake      |
| EmailService | å¤–éƒ¨æœåŠ¡ | Mock      |
| Logger       | å†…éƒ¨æœåŠ¡ | Spy       |

---

ä¸‹ä¸€æ­¥: ä½¿ç”¨ testing:test-case-designer è®¾è®¡æµ‹è¯•ç”¨ä¾‹
```

## è¿”å›å€¼

```
æµ‹è¯•åˆ†æå®Œæˆã€‚
è¾“å‡ºæ–‡ä»¶: ${run_dir}/analysis.md

ğŸ“Š åˆ†æç»“æœ:
- å¯æµ‹è¯•æ¥å£: X ä¸ª
- é«˜ä¼˜å…ˆçº§: Y ä¸ª
- å½“å‰è¦†ç›–ç‡: Z%
- Mock ä¾èµ–: N ä¸ª

ä¸‹ä¸€æ­¥: ä½¿ç”¨ /testing:test-case-designer è®¾è®¡æµ‹è¯•ç”¨ä¾‹
```

## è´¨é‡é—¨æ§

| ç»´åº¦       | æ ‡å‡†             | é˜ˆå€¼ |
| ---------- | ---------------- | ---- |
| æ¥å£è¯†åˆ«   | è¯†åˆ«å‡ºå…¬å¼€æ¥å£   | â‰¥1   |
| ä¼˜å…ˆçº§æ ‡æ³¨ | æ¯ä¸ªæ¥å£æœ‰ä¼˜å…ˆçº§ | 100% |
| ä¾èµ–åˆ†æ   | è¯†åˆ«å¤–éƒ¨ä¾èµ–     | âœ…   |
